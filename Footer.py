import json
import re
import time
import os
import webbrowser
from datetime import datetime
from colorama import init, Fore, Style
import sys

# Initialize colorama
init(autoreset=True)

# Function to extract tg_id from Notpixel invite link
def extract_tg_id(link):
    match = re.search(r'(\d{10,15})', link)
    if match:
        return match.group(1)
    return None

# Function to load existing users from users.json
def load_users():
    try:
        with open('users.json', 'r') as file:
            return json.load(file)
    except FileNotFoundError:
        return {}

# Function to save users data to users.json
def save_users(users):
    with open('users.json', 'w') as file:
        json.dump(users, file, indent=4)

# Function to display the header (including banner)
def display_header():
    banner = """
+------------------------------------------------------------+
| ██████╗ ██████╗ ████████╗██╗    ███╗   ███╗ █████╗ ██╗     |
|██╔═══██╗██╔══██╗╚══██╔══╝██║    ████╗ ████║██╔══██╗██║     |
|██║   ██║██████╔╝   ██║   ██║    ██╔████╔██║███████║██║     |
|██║   ██║██╔═══╝    ██║   ██║    ██║╚██╔╝██║██╔══██║██║     |
|╚██████╔╝██║        ██║   ██║    ██║ ╚═╝ ██║██║  ██║███████╗|
| ╚═════╝ ╚═╝        ╚═╝   ╚═╝    ╚═╝     ╚═╝╚═╝  ╚═╝╚══════╝|
|                                                            |
| ██████╗ ██████╗  ██████╗ ██╗    ██╗    ██╗   ██╗████████╗  |
|██╔════╝ ██╔══██╗██╔═══██╗██║    ██║    ╚██╗ ██╔╝╚══██╔══╝  |
|██║  ███╗██████╔╝██║   ██║██║ █╗ ██║     ╚████╔╝    ██║     |
|██║   ██║██╔══██╗██║   ██║██║███╗██║      ╚██╔╝     ██║     |
|╚██████╔╝██║  ██║╚██████╔╝╚███╔███╔╝       ██║      ██║     |
| ╚═════╝ ╚═╝  ╚═╝ ╚═════╝  ╚══╝╚══╝        ╚═╝      ╚═╝     |
+------------------------------------------------------------+
    """
    print(Fore.CYAN + Style.BRIGHT + banner)
    print(Fore.CYAN + Style.BRIGHT + "----------------------------☠")
    print(Fore.GREEN + Style.BRIGHT + "Notpixel User ID Extractor </> CREATED BY : DR ABDUL MATIN KARIMI ")
    print(Fore.CYAN + "----------------------------☠")

# Function to display footer
def display_footer():
    print(Fore.CYAN + Style.BRIGHT + "----------------------------")
    print(Fore.YELLOW + "Thank you for using the Notpixel User ID Extractor!")
    print(Fore.MAGENTA+ "🔔 DON'T FORGET TO SUBSCRIBE OPTIMALGROWYT CHANNEL 🔔  ")

# Function to open OptimalGrowyt Telegram Channel
def open_optimalgrowyt_channel():
    # OptimalGrowyt Telegram Channel URL
    tg_channel_url = "https://t.me/OptimalGrowyt"
    webbrowser.open(tg_channel_url)
    print(Fore.GREEN + "OptimalGrowyt Telegram Channel opened.")

# Main function to run the script
def main():
    # Display the header
    display_header()

    # Load existing users
    users = load_users()

    while True:
        # Ask for Notpixel invite link with a clear prompt
        invite_link = input(Fore.MAGENTA + "Paste Your Notpixel invite link Here: ").strip()

        # Extract tg_id
        tg_id = extract_tg_id(invite_link)
        if tg_id:
            # Get current timestamp
            timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
            # Add new user
            users[tg_id] = {
                "tg_id": tg_id,
                "saved_at": timestamp
            }
            print(Fore.GREEN + f"Success: Your ID {tg_id} has been successfully added at {timestamp}.")
            # Show the link in blue
            print(Fore.BLUE + f"The link you provided: {invite_link}")
        else:
            print(Fore.RED + "Error: Failed to extract tg_ID from the provided invite link. Please try again.")

        # Ask if the user wants to add more users
        continue_adding = input(Fore.YELLOW + "Do you want to add more users? (Y/N): ").strip().upper()
        if continue_adding != 'Y':
            break

    # Save updated users data to users.json
    save_users(users)
    print(Fore.GREEN + "All users have been saved to users.json.")

    # Display the footer message
    display_footer()

    # Wait for 5 seconds before opening the OptimalGrowyt channel
    time.sleep(5)

    # Open the OptimalGrowyt Telegram Channel
    open_optimalgrowyt_channel()

    # Close the script window automatically after opening the link
    os.system("exit")

if __name__ == "__main__":
    main()
